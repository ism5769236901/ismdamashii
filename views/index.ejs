<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
     
        <header>
            <h1 class="site-title"><a href="/">
                    <img src="/static/logo.png" alt="ism魂" class="site-logo">
                </a></h1>
            <p><%= description %></p>
        </header>
    <div class="container">  
        <main>
            <div class="posts-list">
                <% if (posts.length > 0) { %>
                    <% posts.forEach(post => { %>
                        <article class="post-item">
                            <div class="post-meta">
                                <time datetime="<%= post.date %>">
                                    <%= new Date(post.date).toLocaleDateString('ja-JP') %>
                                </time>
                            </div>
                            <h2 class="post-title">
                                <a href="/post/<%= post.slug %>"><%= post.title %></a>
                            </h2>     
                        </article>
                    <% }) %>
                <% } else { %>
                    <div class="no-posts">
                        <p>まだ記事がありません。</p>
                    </div>
                <% } %>
            </div>
            
            <!-- ページネーション -->
            <% if (pagination.totalPages > 1) { %>
                <nav class="pagination">
                    <div class="pagination-info">
                        <span>
                            <%= pagination.totalPosts %>件中 
                            <%= ((pagination.currentPage - 1) * pagination.perPage + 1) %>-<%= Math.min(pagination.currentPage * pagination.perPage, pagination.totalPosts) %>件を表示
                        </span>
                    </div>
                    
                    <div class="pagination-nav">
                        <% if (pagination.hasPrevPage) { %>
                            <a href="/?page=<%= pagination.prevPage %>" class="pagination-link pagination-prev">
                                &larr; 前のページ
                            </a>
                        <% } %>
                        
                        <div class="pagination-numbers">
                            <% 
                            // ページ番号の表示範囲を計算
                            let startPage = Math.max(1, pagination.currentPage - 2);
                            let endPage = Math.min(pagination.totalPages, pagination.currentPage + 2);
                            
                            // 最初のページを表示
                            if (startPage > 1) { %>
                                <a href="/?page=1" class="pagination-link">1</a>
                                <% if (startPage > 2) { %>
                                    <span class="pagination-dots">...</span>
                                <% } %>
                            <% } %>
                            
                            <% for (let i = startPage; i <= endPage; i++) { %>
                                <% if (i === pagination.currentPage) { %>
                                    <span class="pagination-link pagination-current"><%= i %></span>
                                <% } else { %>
                                    <a href="/?page=<%= i %>" class="pagination-link"><%= i %></a>
                                <% } %>
                            <% } %>
                            
                            <% // 最後のページを表示
                            if (endPage < pagination.totalPages) { %>
                                <% if (endPage < pagination.totalPages - 1) { %>
                                    <span class="pagination-dots">...</span>
                                <% } %>
                                <a href="/?page=<%= pagination.totalPages %>" class="pagination-link"><%= pagination.totalPages %></a>
                            <% } %>
                        </div>
                        
                        <% if (pagination.hasNextPage) { %>
                            <a href="/?page=<%= pagination.nextPage %>" class="pagination-link pagination-next">
                                次のページ &rarr;
                            </a>
                        <% } %>
                    </div>
                </nav>
            <% } %>
        </main>
        
        <footer>
            <p>&copy; 2024 <%= title %></p>
        </footer>
    </div>
</body>
</html>